#include <iostream>
#include <time.h>
#include <string>

using namespace std;

int chislo(string var)
{
    int c = 0;
    for (int i = 0; i < var.size(); i++)
    {
        if (isdigit(var[i]))
        {
            c = 1;
        }
        else
        {
            c = 0;
            break;
        }
    }
    return c;
}

int nul(string var)
{
    int c = 0;
    int a = 0;
    for (int i = 0; i < var.size(); i++)
    {
        a = var[i] - '0';
        if (a > 0)
        {
            c = 1;
        }
        else
        {
            c = 0;
            break;
        }
    }
    return c;
}

int main()
{
	setlocale(LC_ALL, "rus");
	string otvet;
	int const ROW = 9;
	int const COL = 9;
    bool del = true;
    bool nomines = false;
	int arr[ROW][COL];
    string saper[ROW][COL];
    string chose;
    string n;
    string n0str;
    string n1str;
    int n0;
    int n1;
    int c = 0;
    bool mina = false;
	srand(time(NULL));
	while (true)
	{
		cout << "|---------------|" << endl;
		cout << "|Сыграем в игру?|" << endl;
		cout << "|1. Да          |" << endl;
		cout << "|2. Нет         |" << endl;
		cout << "|---------------|" << endl;
		cin >> otvet;
		if (otvet == "1")
		{
            for (int i = 0; i < ROW; i++)
            {
                for (int j = 0; j < COL; j++)
                {
                    arr[i][j] = rand() % 81 - 71;
                    for (int k = 0; k < ROW; k++)
                    {
                        for (int g = 0; g < COL; g++)
                        {
                            if ((i == k) and (j == g))
                            {
                                del = false;
                                break;
                            }
                            else if ((i == k) and (j + 1 == g))
                            {
                                del = false;
                                break;
                            }
                            else
                            {
                                if (arr[i][j] == arr[k][g])
                                {
                                    del = false;
                                    if (j == 0)
                                    {
                                        j = COL - 1;
                                        i = i - 1;
                                    }
                                    else
                                    {
                                        j = j - 1;
                                    }
                                    break;
                                }
                            }

                        }
                        if (del == false)
                        {
                            del = true;
                            break;
                        }
                    }
                }
            }

            for (int i = 0; i < ROW; i++)
            {
                for (int j = 0; j < COL; j++)
                {
                    saper[i][j] = "[]";
                }
            }

            for (int i = 0; i < ROW; i++)
            {
                for (int j = 0; j < COL; j++)
                {
                    cout << saper[i][j] << "\t";
                    if (j == COL - 1)
                    {
                        cout << endl;
                    }
                }
            }

            for (int i = 0; i < ROW; i++)
            {
                for (int j = 0; j < COL; j++)
                {
                    cout << arr[i][j] << "\t";
                    if (j == COL - 1)
                    {
                        cout << endl;
                    }
                }
            }

            while (true)
            {
                cout << "|-----------------|" << endl;
                cout << "|Выберите действие|" << endl;
                cout << "|1. Вскопать      |" << endl;
                cout << "|2. Флажок        |" << endl;
                cout << "|-----------------|" << endl;
                cin >> chose;
                if (chose == "1")
                {
                    cout << "Введите номер элемента" << endl;
                    cin >> n;
                    if ((size(n) == 2) and (chislo(n) == 1) and (nul(n) == 1))
                    {
                        n0str = n[0];
                        n1str = n[1];
                        n0 = stoi(n0str) - 1;
                        n1 = stoi(n1str) - 1;

                        if (arr[n0][n1] >= 0)
                        {
                            cout << "Мина!" << endl;
                            saper[n0][n1] = "[*]";
                            mina = true;
                        }
                        else
                        {
                            for (int i = n0 - 1; i < n0 + 2; i++)
                            {
                                for (int j = n1 - 1; j < n1 + 2; j++)
                                {
                                    if ((i >= 0) and (j >= 0))
                                    {
                                        if (arr[i][j] >= 0)
                                        {
                                            c++;
                                        }
                                    }
                                }
                            }
                            if (c == 0)
                            {
                                for (int i = n0 - 1; i < n0 + 2; i++)
                                {
                                    for (int j = n1 - 1; j < n1 + 2; j++)
                                    {
                                        if ((i >= 0) and (j >= 0))
                                        {
                                            for (int k = i - 1; k < i + 2; k++)
                                            {
                                                for (int g = j - 1; g < j + 2; g++)
                                                {
                                                    if ((k >= 0) and (g >= 0))
                                                    {
                                                        if (arr[k][g] >= 0)
                                                        {
                                                            c++;
                                                        }
                                                    }
                                                }
                                            }
                                            saper[i][j] = "[" + to_string(c) + "]";
                                            c = 0;
                                        }
                                    }
                                }
                            }
                            else
                            {
                                saper[n0][n1] = "[" + to_string(c) + "]";
                                c = 0;
                            }
                        }

                        for (int i = 0; i < ROW; i++)
                        {
                            for (int j = 0; j < COL; j++)
                            {
                                cout << saper[i][j] << "\t";
                                if (j == COL - 1)
                                {
                                    cout << endl;
                                }
                            }
                        }
                        if (mina == true)
                        {
                            mina = false;
                            break;
                        }
                    }
                    else
                    {
                        cout << "Попробуй ещё раз!" << endl;
                    }
                }
                else if (chose == "2")
                {
                    cout << "Введите номер элемента" << endl;
                    cin >> n;
                    if ((size(n) == 2) and (chislo(n) == 1) and (nul(n) == 1))
                    {
                        n0str = n[0];
                        n1str = n[1];
                        n0 = stoi(n0str) - 1;
                        n1 = stoi(n1str) - 1;

                        saper[n0][n1] = "[!]";

                        for (int i = 0; i < ROW; i++)
                        {
                            for (int j = 0; j < COL; j++)
                            {
                                cout << saper[i][j] << "\t";
                                if (j == COL - 1)
                                {
                                    cout << endl;
                                }
                            }
                        }
                    }
                    else
                    {
                        cout << "Попробуй ещё раз!" << endl;
                    }
                }
                else
                {
                    cout << "Попробуй ещё раз!" << endl;
                }
            }
		}
		else if (otvet == "2")
		{
			cout << "((((" << endl;
			break;
		}
		else
		{
			cout << "Попробуй ещё раз!" << endl;
		}
	}
}
